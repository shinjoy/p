function numbersonly(t,e){var n,a;if(window.event)n=window.event.keyCode;else{if(!t)return!0;n=t.which}return a=String.fromCharCode(n),null==n||0==n||8==n||9==n||13==n||27==n?!0:"0123456789".indexOf(a)>-1?!0:e&&"."==a?!0:!1}function divPosition(t,e){var n=document.documentElement.clientWidth,a=$("#"+t).offset(),o=$("#"+e).outerWidth();null!=a&&$("#"+e).css({top:a.top+15,left:a.left+o<n?a.left:n-(o+8)})}function divShow(t,e){var n=t.attr("id");divPosition(n,e),$("#"+e).css("display","block"),$("#"+e).show()}function Request(t){var e,n=location.href,a=new Array;a=n.slice(n.indexOf("?")+1,n.length).split("&");for(var o=0;o<a.length;o++)if(-1!=a[o].indexOf(t))return e=a[o].split("=")[1],(void 0==e||null==e)&&(e=""),e}function popUp(t,e,n,a){var o="740",r="740",i=screen.availHeight-30,s=screen.availWidth-10,c=(new Object,"");if("c"==e)c="../work/popUpCpn.do",c+="?f="+e+"&n="+t,o="500",r="600";else if("ceo"==e|"p"==e|"pp"==e|"ppp"==e|"workNetp"==e|"iP"==e)c="../work/popUpCst.do",c+="?f="+e+"&n="+t,o="500",r="600";else if("C"==e||"workNetC"==e)c="../person/popUpCst.do",c+="?f="+e+"&n="+t+"&snb="+a+"&nm="+n,o="600",r="600";else if("PersonCPN"==e||"PersonCPNnet"==e||"workNetPersonCPN"==e||"workNetPersonCPNnet"==e)c="../person/popUpCpn.do",c+="?f="+e+"&snb="+a+"&nm="+n,c+="PersonCPNnet"==e||"workNetPersonCPNnet"==e?"&n2t=Y":"&n2t=N",o="500",r="600";else if("modiCst"==e)c="../person/modifyCst.do",c+="?f="+e+"&sNb="+a+"&nm="+n;else if("CC"==e||"DD"==e){var l=check_personInput();if(0==l)return;c="../person/popUpCst.do",c+="?f="+e+"&snb="+a+"&nm="+n,o="500",r="600"}else if("cExcel"==e)c="../company/popUpExcel.do";else if("cstExcel"==e)c="../person/popUpExcel.do";else if("files"==e){var d=parseInt(t)<10?"0"+t:t;3===d.length&&(d=d.substring(1,3)),day=$("#choiceYear").val()+$("#choiceMonth").val()+d,c="../work/multiUpload.do",c+="?f="+e+"&n="+t+"&nm="+n+"&snb="+$("#offerSnb").val()+"&day="+day,c+=1==$("#reportYN_ input:checkbox").is(":checked")?"&report=Y":"&report=N",o="500",r="600"}else if("rcmdCpn"==e)c="../company/main.do",c+="?sNb="+a,o="860";else if("rcmdCst"==e)c="../person/main.do",c+="?f="+e+"&sNb="+a+"&popUp=Y";else if("rcmdComment"==e){c="../recommend/comment.do";var p=t.split("-");c+="?sNb="+a+"&choiceYear="+p[0]+"&choiceMonthS="+p[1]}else"rcmdWork"==e?(c="../work/popUpRecommend.do",c+="?f="+e+"&n="+t+"&sNb="+a,o="500",r="600"):"workMemo"==e?c="../work/popUpMemo.do":"supporter"==e?(c="../work/popUpSup.do",c+="?f="+e+"&sNb="+a):"introducer"==e?(c="../work/popUpIntroducer.do",t=$("#choiceYear").val()+$("#choiceMonth").val()+t,c+="?f="+e+"&dt="+t+"&sNb="+a,o="500",r="400"):"meeTing"==e?(c="../person/meeTing.do",c+="?f="+e+"&sNb="+a,o="500",r="600"):"meeTingList"==e&&(c="../person/meeTingList.do",c+="?f="+e+"&num="+t,o="500",r="600");r=i-40>r?r:i-40;var m=(s-o)/2,u=(i-r)/2,f="left="+m+",top="+u+",width="+o+",height="+r+",menubar=no,status=no,toolbar=no,location=no,scrollbars=yes,resizable=no";window.open(c,"_blank",f)}function returnPopUp(t){var e=t.f,n=t.nm,a=t.n;if("c"==e)$("#AP"+a).focus(),null!=t.nm&&$("#AP_cpnNm_"+a).html(t.nm),null!=t.snb&&($("#AP_cpnId_"+a).val(t.snb),null!=t.cpnSnb&&$("#AP_CpnSnb_"+a).val(t.cpnSnb),"mc"==a&&afterMatchingCpn(),"00014"!=$("#categoryCd_").val()&&"00002"==$("#rcmdWorkSpan_"+a).parent().find("[class^=work-2ndSelect]").val()&&($("#rcmdWork_"+a).attr("onclick","popUp('"+a+"','rcmdWork','','"+t.snb+"')"),popUp(a,"rcmdWork","",t.snb)));else if("p"==e)null!=t.nm&&$("#AP_cstNm"+a).html(t.cpnNm+" : "+t.nm),null!=t.snb&&$("#AP_cstId"+a).val(t.snb),null!=t.snb&&$("#AP_cpnSnb"+a).val(t.cpnSnb),"00006"!=$("#offerCd"+a).val()&&"00007"!=$("#offerCd"+a).val();else if("pp"==e|"ppp"==e)null!=t.nm&&("pp"==e?$("#intro_cstNm"+a).html("<b>거래상대방</b><br/>"+t.cpnNm+"<br/>"+t.nm):$("#intro_cstNm"+a).html(t.cpnNm+" : "+t.nm)),null!=t.snb&&$("#rgSnb"+a).val(t.snb);else{if("workNetp"==e)return null!=t.nm&&($("#sltPerNetName"+a).html(t.cpnNm+" : "+t.nm),$("#perNetName"+a).val(t.nm)),void(null!=t.snb&&($("#perNetSnb"+a).val(t.snb),popUp("","rcmdCst","",t.snb)));if("rcmdCst"==e)document.modifyRec.submit();else if("introducer"==e)"del"==t.nm&&document.modifyRec.submit();else if("iP"==e)null!=t.nm&&$("#AP_infoProviderNm"+a).html(t.cpnNm+" : "+t.nm),null!=t.snb&&$("#AP_infoProviderId"+a).val(t.snb);else if("C"==e||"PersonCPN"==e||"PersonCPNnet"==e){$("#s_Name").val(t.snb);var o=document.getElementById("customerName");if("popUp"!=$("#rtn").val()){var r="mainFrame";"Y"==parent.insertStockFirmIbYN()&&(r="stockCstFrame"),o.target=r}o.submit()}else if("workNetC"==e||"workNetPersonCPN"==e||"workNetPersonCPNnet"==e)null!=t.cpNcsNm&&("workNetC"==e&&$("#prtPerNet"+a).html(t.cpNcsNm+"<br/>"+t.note),"workNetPersonCPNnet"==e&&$("#prtCopNet"+a).html(t.cpNcsNm+"<br/>"+t.note),"workNetPersonCPN"==e&&$("#prtDealNet"+a).html(t.cpNcsNm+"<br/>"+t.note));else if("modiCst"==e)null!=t.snb&&(alert("저장되었습니다."),$("#s_Name").val(t.snb),$("#customerName").submit());else if("CC"==e){if(null!=t.snb){$("#s_Name").val(t.snb);var o=document.getElementById("customerName");o.target="mainFrame",o.submit()}}else if("rcmdWork"==e)null!=t.snb&&$("#rcmderSnb_"+a).val(t.snb),null!=t.nm&&$("#rcmdWork_"+a).html(t.nm);else if("meeTingList"==e)null!=t.snb&&$("#meetSnb_"+a).val(t.snb),null!=n&&$(".link:eq("+parseInt(a-1)+")").html(n);else if("DD"==e);else if("files"==e){t.status;"recommend"==t.nm&&($("#dayForm").action="index.do",$("#dayForm").submit()),null!=t.snb&&$("#offerSnb").val(t.snb),$("#fileAdd_").attr("style","display:none")}else if("ceo"==e&&confirm("적용하시겠습니까?")){var i=t.cpnId;$.ajax({type:"POST",url:"../company/updateCpn.do",data:{cpnId:i,ceoId:t.snb},timeout:3e4,cache:!1,success:function(t){$("#i_Name").val(i);var e=document.getElementById("companyName");e.target="mainFrame",e.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}}}function sortUser(t,e,n){var a=$(t);$("li .bgOrg").removeClass("bgOrg"),$("#s_Name").val(e),$("#s_Id").val(n),a.addClass("bgOrg");var o=parent.mainFrame.choiceYear;$("#s_year").val(null==o?"":o.value);var r=document.getElementById("staffName");r.target="mainFrame",r.submit()}function month(t,e){var n=document.modifyRec;$("#choiceMonth").val(t),$("#cc_year").val($("#choiceYear").val()),n.action=e,n.submit()}function chkval(t){for(var e=t.checkbox,n=!1,a=0;a<e.length;a++)n=n||e[a].checked;return n}function getWeekday(t){var e=parseInt(t.substr(0,4),10),n=parseInt(t.substr(5,2),10),a=parseInt(t.substr(8),10),o=new Date(e,n-1,a),r=new Array(7);return r[0]="일",r[1]="월",r[2]="화",r[3]="수",r[4]="목",r[5]="금",r[6]="토",r[o.getDay()]}function recommendSubMemo(t,e,n,a,o){if(confirm("적용하시겠습니까?")){var r=$(t).parent().parent().parent(),i="";a.length>0&&(i="rcmdSendMemo");var s={sNb:r.find("[id^=dealMemoSNb]").val(),subMemo:r.find("[id^=memoarea]").val(),tmpNum1:i,cpnNm:e,rgNm:a,progressCd:o,rgId:$("#rgstId").val()},c="../work/modifyDealMemo.do",l=function(){document.modifyRec.submit()};ajaxModule(s,c,l)}}function totalView(t){"total"==t&&$("#total").val(t),document.dayForm.submit()}function sortTable(t,e){"total"==t||"sellBuy"==t?($("#total").val(t),$("#sorting").val(e)):$("#sorting").val(t),document.modifyRec.submit()}function selectTab(t,e){"total"==t||"sellBuy"==t?($("#total").val(t),$("#tab").val(e)):$("#tab").val(t),document.modifyRec.submit()}function selectLv(t,e,n){var a={sNb:e,lvCd:"0000"+t},o="../work/saveLv.do",r=function(){$("#"+n).submit()};ajaxModule(a,o,r)}function slctCpn(t,e){$("body").append('<form id="companyName" name="companyName" action="../company/main.do" method="post"><input type="hidden" id="cpn_Name" name="sNb"/></form>');var n="mainFrame";$("#cpn_Name").val(t),"function"==typeof parent.insertStockFirmIbYN&&"Y"==parent.insertStockFirmIbYN()&&(n="stockCstFrame");var a=document.getElementById("companyName");a.target=n,a.submit()}function rgstCpn(){$("#c_Name").val($("#nameSearch").val());var t=document.getElementById("rgstCpnNm");t.target="mainFrame",t.submit()}function popRgstCpn(){var t=document.getElementById("insertCpn");t.action="popRgstCpn.do",t.submit()}function slctCst(t){if("none"!=$(".popUpBtn").css("display")){$("#s_Name").val(t);var e=document.getElementById("customerName");e.target="mainFrame","Y"==parent.insertStockFirmIbYN()&&(e.target="stockCstFrame"),e.submit()}}function popRgstCst(t){0==t&&(t=""),$("#s_Name").val($("#nameSearch").val()+t),$("#s_Name2").val($("#nameSearch").val()+t);var e=document.getElementById("insertCst");e.action="popRgstCst.do",e.submit()}function check_personInput(){var t=$("#cst_nm"),e=$("#AP_cpnId_0"),n=$("#position"),a=$("#email"),o=$("#phn_1"),r=$("#phn_2"),i=$("#phn_3");return t.val().is_null()?(alert("이름을 입력하세요."),t.focus(),0):n.val().is_null()?(alert("직위을 입력하세요."),n.focus(),0):a.val().is_null()?(alert("email을 입력하세요."),a.focus(),0):o.val().is_null()?(alert("전화번호를 입력하세요."),o.focus(),0):0!=$("#cst_snb").val().length?2:($.ajax({type:"POST",url:"../person/AjaxInsertCst.do",data:{cstNm:t.val(),cpnId:e.val(),position:n.val(),email:a.val(),phn1:o.val(),phn2:r.val(),phn3:i.val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){var e=t.split("_"),n=e[0],a=e[1];$("#cst_snb").val(a),$("#addNtw").attr("onclick","popUp('_0','CC','"+n+"','"+a+"'); return false;")},error:function(t,e){ajaxErrorAlert(t,e)}}),1)}function ntwk_btnOK(t){var e=new Object,n=$("#TMname").val(),a=$("#TMsnb").val(),o=$("#name2nd").val(),r=$("#resultarea0").val();"메모사항.."==r&&(r=null),"cst"==t?URL="../person/insertNetwork.do":"cpn"==t&&(URL="../person/insertCstDealInfo.do"),confirm("적용하시겠습니까?")&&$.ajax({type:"POST",url:URL,data:{snb1st:a,snb2nd:$("#sNb2nd").val(),netYN:$("#netYN").val(),note:$("#resultarea0").val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){e.f=$("#TMf").val(),e.n=$("#TMn").val(),e.nm=n,e.snb=a,e.cpNcsNm=o,e.note=r,window.opener&&window.opener.returnPopUp(e),window.close()},error:function(t,e){ajaxErrorAlert(t,e)}})}function browserCheck(){return"Netscape"==navigator.appName?"FF":"Microsoft Internet Explorer"==navigator.appName?-1!=navigator.appVersion.indexOf("MSIE6")||-1!=navigator.appVersion.indexOf("MSIE 6")?"IE6":-1!=navigator.appVersion.indexOf("MSIE7")||-1!=navigator.appVersion.indexOf("MSIE 7")?"IE7":-1!=navigator.appVersion.indexOf("MSIE8")||-1!=navigator.appVersion.indexOf("MSIE 8")?"IE8":-1!=navigator.appVersion.indexOf("MSIE9")||-1!=navigator.appVersion.indexOf("MSIE 9")?"IE9":navigator.appVersion:"else"}function check_id(t){return 2>t.val().length||t.val().length>12?(alert("ID는 3~12자 사이로해주세요."),!1):/[a-zA-Z]/.test(t.val())||/[0-9]/.test(t.val())?!0:(alert("ID는 3~12자 영문과 숫자여야 합니다."),!1)}function jsNull(t){return""==t||null==t||"undefined"==t?!0:!1}function jsNumeric(t){if(jsNull(t))return!0;for(var e=0;e<t.length;e++)if(t.charAt(e)<"0"||t.charAt(e)>"9"||t.charCodeAt(e)>127)return!1;return!0}function CheckPassWord(t){if(!t.match(/([a-zA-Z].*[0-9])|([a-zA-Z].*[!,@,#,$,%,^,&,*,?,_,~])|([0-9].*[a-zA-Z])|([0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[0-9])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z])/))return alert("비밀번호는 문자,숫자,특수문자의 조합으로 10자리까지 입력가능합니다."),!1;for(var e,n,a=0,o=0,r=0,i=0;i<t.length;i++){if(e=t.charAt(i),n=t.charAt(i+1),e==n&&(a+=1),e.charCodeAt(0)-n.charCodeAt(0)==-1){if(o+=1,o>1)return alert("연속된 문자열 (123 또는 321,abc,cba 등)을 3자 이상 사용할수 없습니다."),!1}else o=0;if(e.charCodeAt(0)-n.charCodeAt(0)==1){if(r+=1,r>1)return alert("연속된 문자열 (123 또는 321,abc,cba 등)을 3자 이상 사용할수 없습니다."),!1}else r=0}return a>1?(alert("동일문자를 3번 이상 사용할수 없습니다."),!1):!0}function ajaxModule(t,e,n){$.ajax({type:"POST",url:e,data:t,timeout:3e4,cache:!1,success:function(t){n(t)},error:function(t,e){ajaxErrorAlert(t,e)}})}function ajaxErrorAlert(t,e){0==t.status?alert("code: "+t.status+"\r\nYou are offline!!\r\nPlease Check Your Network."):404==t.status?alert("code: "+t.status+"\r\nRequested URL not found."):500==t.status?alert("code: "+t.status+"\r\nInternel Server Error."):"parsererror"==e?alert("code: "+t.status+"\r\nError.nParsing JSON Request failed."):"timeout"==e?alert("code: "+t.status+"\r\nRequest Time out."):alert("code: "+t.status+"\r\nUnknow Error.\r\n"+t.responseText)}function insertPersonnelData(){for(var t=$(".viewPersonnel"),e=$(".viewPersonnel:first"),n=$(".viewPass"),a=$(".viewPass:first"),o=$(".viewTotalTrad"),r=$(".viewTotalTrad:first"),i=0,s=1,c=1,l=0;l<o.length;l++){var d=r.attr("id"),p=d.split("_"),m=$("#"+d).val();0!=m&&0!=p[2]&&$("#"+p[0]+"_totSumCnt").html(m),r=r.next()}for(var l=0;l<n.length;l++){var d=a.attr("id"),p=d.split("_"),u=parseFloat($("#"+d).val()),f=parseFloat($("#"+p[0]+"_supHol").html()-u);$("#"+p[0]+"_passYear").html(u),$("#"+p[0]+"_supHol").html(f),$("#"+p[0]+"_total").html(f),a=a.next()}for(var l=0;l<t.length;l++){var d=e.attr("id");null==d&&(e=e.next(),d=e.attr("id"));var v=$("#"+d).val(),p=d.split("_");if($("#"+p[0]+"_view_"+p[2]).html(v),0==parseInt(p[2])&&$("#"+p[0]+"_late").html(v),e=e.next(),s!=p[0]){var h=parseFloat($("#"+s+"_total").html())-parseFloat(i);0>=h?($("#"+s+"_overH").val(h),0>h&&$("#"+s+"_total").html('<font style="color:crimson">'+h+"</font>"),0==h&&$("#"+s+"_total").html(h)):$("#"+s+"_total").html(h),i=0,c=1}else 0!=p[2]&&c++;i=parseFloat(i)+parseFloat(v),s=p[0],$("#"+p[0]+"_sum").html(i),$("#"+p[0]+"_sumCnt").html(c)}var h=parseFloat($("#"+s+"_total").html())-parseFloat(i);0>=h?($("#"+s+"_overH").val(h),0>h&&$("#"+s+"_total").html('<font style="color:crimson">'+h+"</font>"),0==h&&$("#"+s+"_total").html(h)):$("#"+s+"_total").html(h)}function insertModifyPagePersonnelData(){for(var t=$(".viewPersonnel"),e=$(".viewPersonnel:first"),n=$(".viewTotalTrad"),a=$(".viewTotalTrad:first"),o=0,r=1,i=1,s=0;s<n.length;s++){var c=a.attr("id"),l=c.split("_"),d=$("#"+c).val();0!=d&&0!=l[2]&&$("#"+l[0]+"_totSumCnt").html(d),a=a.next()}for(var s=0;s<t.length;s++){var c=e.attr("id");null==c&&(e=e.next(),c=e.attr("id"));var p=$("#"+c).val(),l=c.split("_");if($("#"+l[0]+"_view_"+l[2]+" input").val(p),0==parseInt(l[2])&&$("#"+l[0]+"_late input").val(p),e=e.next(),r!=l[0]){var m=parseFloat($("#"+r+"_total").html())-parseFloat(o);$("#"+r+"_total").html(m),o=0,i=1}else 0!=l[2]&&i++;o=parseFloat(o)+parseFloat(p),r=l[0],$("#"+l[0]+"_sum").html(o),$("#"+l[0]+"_sumCnt").html(i)}$("#"+r+"_total input").html(parseFloat($("#"+r+"_total").html())-parseFloat(o))}function insertDate(t,e,n){return numbersonly(t,e)?(alert("test"),alert(n.parent().val()),alert(n.child().val()),void(4==n.val().length?n.val(n.val()+"-"):6==n.val().replace("-","").length&&n.val(n.val()+"-"))):!1}function insertUl(t){var e=$("#"+t+" .tbody:eq(-1)").clone();e.find("li input:text").val(""),e.find("li select").val(""),$("#"+t).append(e)}function downup(t,e){var n=$("#dynamicTbl .dnTbl:eq("+(t+e)+")"),a=$("#dynamicTbl .dnTbl:eq("+t+")"),o=$("#dynamicTbl .dnTbl").length-1;t+e==1?a.find("input:button").attr("onclick",""):a.find("input:button").attr("onclick","downup("+(t+e)+",-1)"),t+e==o?a.find("span a").attr("onclick",""):a.find("span a").attr("onclick","downup("+(t+e)+",1)"),n.find("input:button").attr("onclick","downup("+t+",-1)"),n.find("span a").attr("onclick","downup("+t+",1)"),0>e?n.before(a):e>0&&n.after(a)}function removeTr(t){var e=$(".tbl"+t);if(confirm("삭제하시겠습니까?")){e.find("td input, td select").val("");var n=document.getElementById("planForm");n.action="insertBsnsPlan.do",n.submit()}}function bsnsPsave(t,e){var n=e.split("_"),a="";"bsnsPlan"==t&&(a="../bsnsPlan/insertBsnsPlanNote.do");var o={sNb:$("#bsnsPsnb"+n[1]).val(),note:$("#memoarea"+n[1]).val(),feedback:$("#memoarea"+n[1]).val()},r=function(){$("#bsnsPmemo_"+n[1]).hide()};ajaxModule(o,a,r)}function selectOpinion(t,e,n){$(".popUpMenu").hide(),$("#insertOpinionBtn").attr("onclick","saveOpinion('','"+n+"');"),divShow($(t),e);e.split("workPr")}function divUp(t,e,n){var a=e+"rcmdDIV"+n;$("#updateOpinionBtn"+n).attr("onclick","saveOpinion('"+n+"','"+e+"');"),$("#deleteOpinionBtn"+n).attr("onclick","saveOpinion('"+n+"');"),$(".popUpMenu").hide(),divShow($(t),a)}function updateRCMD(t,e,n,a){var o=null;if("rslt"==t?o={sNb:n,result:e}:"progress"==t?o={sNb:n,progressCd:e}:"proposer"==t?o={sNb:n,rcmdProposer:$(".chbox:checked").val(),cpnNm:a,subMemo:"N"}:"price"==t&&(o={sNb:n,price:e}),confirm("적용하시겠습니까?")){var r="../recommend/updateResult.do",i=function(){document.companyName.action="index.do",document.companyName.submit()};ajaxModule(o,r,i)}}function saveOpinion(t,e){var n;if(n=""==t?{offerSnb:e,opinion:$("input[name=opinion]:checked").val(),comment:$("#txtarea0").val()}:""!=e?{sNb:$("#OPsNb"+t).val(),offerSnb:e,opinion:$("input[name=opinion"+t+"]:checked").val(),comment:$("#txtarea"+t).val()}:{sNb:$("#OPsNb"+t).val()},confirm("적용하시겠습니까?")){var a="../recommend/saveOpinion.do",o=function(){document.companyName.action="index.do",document.companyName.submit()};ajaxModule(n,a,o)}}function staffDiv(t,e,n,a){$(".popUpMenu").hide(),$("#saveBTN").attr("onclick","updateRCMD('proposer','','"+n+"','"+a+"');"),divShow($(t),e)}function write_cancle(t,e){"ist"==t?($(".new_cmt").css("display","none"),$("#toast_comment_text").val("")):"mdf"==t&&($("#user_text"+e).css("display","block"),$("#modi_textarea"+e).css("display","none"))}function modify_comment(t){$("#user_text"+t).css("display","none"),$("#modi_textarea"+t).css("display","block")}function selectLvCd(t,e,n,a,o,r){var i=$(r),s="0000"+e,c=($("#cst_snb").val(),t),l=i.parent().parent(),d=l.find("[class*=bgLightGray]").size();if(e==d);else if(e>d)for(var p=d;e>p;p++)l.find("[class*=tabImportant]:eq("+p+")").addClass("bgLightGray");else if(d>e)for(var p=d-1;p>=e;p--)l.find("[class*=tabImportant]:eq("+p+")").removeClass("bgLightGray");var m={sNb:n,lvCd:s,flag:c},u="../person/saveLvCd.do",f=function(a){"NP"===t&&parseInt(e)>2&&parseInt(a)>0&&($("#AP_cstId_0").val($("#snb2"+n).val()),$("#NPrgId").val($("#snb1"+n).val()),$("#NPrgNm").html($("#npnm"+n).val()),view("tbl00",o))};ajaxModule(m,u,f)}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/gi,"")},Object.defineProperty(Object.prototype,"is_null",{value:function(){return null===this||""===String(this).trim()?!0:!1}}),$(function(){function t(t){$("#info").css("display",t),$("#price").css("display",t),$("#invest").css("display",t),$("#comp1").css("display",t),$("#name1").css("display",t),$("#team1").css("display",t),$("#input4").css("display",t),$("#input5").css("display",t),$("#input6").css("display",t),$("#input7").css("display",t),$("#input8").css("display",t)}function e(t){$("#name0").css("display",t),$("#team0").css("display",t),$("#input2").css("display",t),$("#input3").css("display",t)}function n(t){var e=t.attr("id");o=e,a(e,r),$("#"+r).css("display","block"),$("#"+r).show()}function a(t,e){var n=document.documentElement.clientWidth,a=$("#"+t).offset(),o=$("#"+e).outerWidth();null!=a&&$("#"+e).css({top:a.top+15,left:a.left+o<n?a.left:n-(o+8)})}navigator.userAgent.indexOf("Firefox")>=0&&!function(){for(var t=["mousedown","mouseover","mouseout","mousemove","mousedrag","click","dblclick"],e=0;e<t.length;e++)window.addEventListener(t[e],function(t){window.event=t},!0)}(),$("#workMeet").click(function(){t("none"),e("")}),$("#workIR").click(function(){t("none"),e("")}),$("#workVisit").click(function(){t("none"),e("")}),$("#workAnalysis").click(function(){t("none"),e("")}),$("#workSurvey").click(function(){t("none"),e("")}),$("#workDealS").click(function(){t(""),e("none")}),$("#workDealR").click(function(){t(""),e("none")}),$(document).on("change",".offerCd",function(){var t=$(this);switch(t.val()){case"00001":case"00002":case"00003":t.parent().parent().find("[id^=slctPrsn_]").css("display",""),t.parent().parent().find("[id^=slctCpn_]").css("display","none"),t.parent().parent().find("[id^=CateCd_]").css("display","none"),t.parent().parent().find("[id^=AP_price]").css("display","none"),t.parent().parent().find("[id^=textTmp_]").css("display","none"),t.parent().parent().find("[id^=KP_title_]").css("display",""),t.parent().parent().find("[id^=KP_slct_]").css("display","");break;case"00004":case"00005":t.parent().parent().find("[id^=slctCpn_]").css("display",""),t.parent().parent().find("[id^=slctPrsn_]").css("display","none"),t.parent().parent().find("[id^=CateCd_]").css("display","none"),t.parent().parent().find("[id^=AP_price]").css("display","none"),t.parent().parent().find("[id^=textTmp_]").css("display","none"),t.parent().parent().find("[id^=KP_title_]").css("display",""),t.parent().parent().find("[id^=KP_slct_]").css("display","");break;case"00006":case"00007":t.parent().parent().find("[id^=slctCpn_]").css("display",""),t.parent().parent().find("[id^=slctPrsn_]").css("display",""),t.parent().parent().find("[id^=CateCd_]").css("display",""),t.parent().parent().find("[id^=AP_price]").css("display",""),t.parent().parent().find("[id^=textTmp_]").css("display",""),t.parent().parent().find("[id^=KP_title_]").css("display","none"),t.parent().parent().find("[id^=KP_slct_]").css("display","none")}});var o="",r="";$(document).on("click",".netPnt",function(){var t=$(this),e=t.attr("id").split("_");r=(parseInt(e[0])<10?"0"+e[0]:e[0])+e[1]+e[2],$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".closePopUpMenu",function(t){$(".popUpMenu").hide()}),$(document).on("click",".memo_m",function(){var t=$(this).attr("id").split("_");r="memoPr"+t[1],$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".result_m",function(){var t=$(this).attr("id").split("_");r="resultPr"+t[1],$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".opinion_m",function(){var t=$(this).attr("id").split("_");r="opinionPr"+t[1],$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".pass2pe",function(){var t=$(this).attr("id").split("_");r="test_"+t[1],n($(this))}),$(".addItemBtn").click(function(){var t=$(this),e=t.attr("name").split("_"),n=e[e.length-1],a="#dynamicDIV"+n,o=$(a+" ul:last").attr("class").replace(n+"_item_",""),r=$(a+" ul:eq(0)").clone();r.removeClass(),r.addClass(n+"_item_"+(parseInt(o)+1)),r.find("a:eq(0)").attr("id",n+"_btnPass_"+(parseInt(o)+1)),r.find("a:eq(1)").attr("id",n+"_memo_"+(parseInt(o)+1));var i=parseInt(n)<10?"0"+n:n,s=$("#"+i+"memoPr0"),c=$(s).clone();c.attr("id",i+"memoPr"+(parseInt(o)+1)),c.find("input").attr("value",""),$(a).append(r),$(s).parent().append(c);var l="#dbody"+n;$(l).css("padding-bottom","+=20px"),$(l+" li").css("height","+=20px"),$(".memoLine").css("height","20px")}),$(document).on("click",".filePosition",function(){var t=$(this).parent(),e=$(this).attr("id"),n=e.split("ile");$("#makeName").val(t.find("[id^=mkNames"+n[1]+"]").val());var a="../work/downloadProcess.do";window.open(a+"?recordCountPerPage=0&makeName="+$("#makeName").val())}),$(".viewKeyP").click(function(){var t=$(this),e=t.attr("id"),n=e.split("_");$("#KP_slct_"+n[1]).css("display",""),$("#"+e).css("display","none")}),$(document).on("click",".slctCoworker",function(){var t=$(this).parent().parent().parent(),e=t.attr("id").split("_");$("#snb").val($("#snb"+e[1]).val());var n=document.getElementById("modifyRec");n.target="mainFrame",n.submit()}),$(document).on("change",".processKPC",function(){var t=$(this),e=t.attr("id").split("_"),n=document.getElementById("procKPC"+e[1]);n.target="mainFrame",n.submit()}),$(document).on("change","#feedback",function(){var t=$(this).parent().parent();$.ajax({type:"POST",url:"../work/changeFeedback.do",data:{sNb:t.find("[id^=offerSnb]").val(),feedback:$(this).val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}),$(document).on("change","#progressCd",function(){var t=$(this).parent().parent(),e=t.find("[id^=offerSnb]").val();"00003"==$(this).val()&&popUp("","supporter","",e),$.ajax({type:"POST",url:"../work/changeprogressCd.do",data:{sNb:e,cstId:t.find("[id^=cstSnb]").val(),progressCd:$(this).val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}),$(document).on("click",".dealMemo_btnOk",function(){if(confirm("적용하시겠습니까?")){var t=$(this).parent().parent().parent();$.ajax({type:"POST",url:"../work/modifyDealMemo.do",data:{sNb:t.find("[id^=dealMemoSNb]").val(),cstId:t.find("[id^=dealResultCstId]").val(),memo:t.find("[id^=memoarea]").val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}}),$(document).on("click",".dealResult_btnOk",function(){var t=$(this).parent().parent().parent(),e=t.attr("id").split("Pr"),n=null,a=$("#rgstId").val();if("opinion"==e[0]){if(!confirm("적용하시겠습니까?\n메모가 전달됩니다."))return;n={sNb:t.find("[id^=dealOpinionSNb]").val(),opinion:t.find("[id^=opinionarea]").val(),rgId:a,tmpNum1:"op"}}else{if(!confirm("적용하시겠습니까?"))return;n={sNb:t.find("[id^=dealResultSNb]").val(),result:t.find("[id^=resultarea]").val(),rgId:a,tmpNum1:"rs"}}$.ajax({type:"POST",url:"../work/modifyDealResult.do",data:n,timeout:3e4,cache:!1,success:function(t){document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}),$(document).on("click",".comment_m",function(){var t=$(this).attr("id").split("_");r="commentPr"+t[1],$("#TMP"+t[1]).val(t[2]),$(".popUpMenu").hide(),n($(this))}),$(".mna_btnOk").click(function(){if(confirm("적용하시겠습니까?")){var t=$(this).parent().parent().parent(),e=t.find("[id^=TMP]").val();""==t.find("[id^=commentSNb]").val()?$.ajax({type:"POST",url:"../work/insertCommentMna.do",data:{offerId:$("#offerSnb"+e).val(),cpnNm:t.find("[id^=AP_cpnNm]").html(),cstNm:t.find("[id^=AP_cstNm]").html(),progressCd:t.find("[id^=progressCd]").val(),categoryCd:t.find("[id^=categoryCd]").val(),tmDt:$("#offerTmDt"+e).val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){document.modifyRec.action="selectWorkMnA.do",document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}}):$.ajax({type:"POST",url:"../work/updateCommentMna.do",data:{sNb:t.find("[id^=commentSNb]").val(),cpnNm:t.find("[id^=AP_cpnNm]").html(),cstNm:t.find("[id^=AP_cstNm]").html(),progressCd:t.find("[id^=progressCd]").val(),categoryCd:t.find("[id^=categoryCd]").val(),tmDt:$("#offerTmDt"+e).val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){document.modifyRec.action="selectWorkMnA.do",document.modifyRec.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}}),$(document).on("change","#deal_select_year",function(){$("#dayForm").submit()}),$("#offerListed").click(function(){$("#offerNlisted").attr("checked",null),$(this).attr("checked","checked"),$("#cpn_id").focus(),$("#cpn_id").css("display",""),$("#cpn__id").css("display","none")}),$("#offerNlisted").click(function(){$("#offerListed").attr("checked",null),$(this).attr("checked","checked"),$("#cpn__id").css("display",""),$("#cpn_id").css("display","none")}),$(".newCpn_btnOk").click(function(){var t=$(this).parent().parent().parent().parent().parent(),e=t.find("[checked=checked]").attr("id");if("offerListed"==e&&6!=$("#cpn_id").val().length)return void alert("숫자 6자리 코드를 입력하세요.");var n="offerListed"==e?"A"+$("#cpn_id").val():$("#cpn__id").html(),a=$("#cpn_nm").val(),o=0,r=0;return"popUpReg"==$("#tmpTak").val()&&(r=1),$("input").css("background-color",""),n.is_null()?($("#cpn_id").css("background-color","#A9F5BC"),alert("상장코드를 입력하세요."),void("offerListed"==e?$("#cpn_id").focus():$("#cpn__id").focus())):a.is_null()?($("#cpn_nm").focus(),$("#cpn_nm").css("background-color","#A9F5BC"),void alert("회사명을 입력하세요.")):(o.is_null()&&(o=0),void(confirm("적용하시겠습니까?")&&$.ajax({type:"POST",url:"../company/insertCpn.do",data:{cpnId:n,cpnNm:a,ceoId:o,rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){if($("#c_Name").val(n),1!=r){var e=document.getElementById("companyName");e.target="mainFrame",e.submit(),e=document.getElementById("companyLeft"),e.target="leftFrame",e.submit()}else End(n,a)},error:function(t,e){ajaxErrorAlert(t,e)}})))}),$(".excel_btnOk").click(function(){var t=$("#fileCpn").val();confirm("적용하시겠습니까?")&&$.ajax({type:"POST",url:"../company/ExcelProcess.do",data:{fileUrl:t},timeout:3e4,cache:!1,success:function(t){$("#c_Name").val(cpnId);var e=document.getElementById("companyName");e.target="mainFrame",e.submit(),e=document.getElementById("companyLeft"),e.target="leftFrame",e.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}),$(".newCst_btnOk").click(function(){var t=0,e=$("#cst_nm"),n=$("#AP_cpnId_0"),a=$("#position"),o=$("#email"),r=$("#phn_1"),i=$("#phn_2"),s=$("#phn_3"),c=$("#exposure"),l=1;$("input[class=categoryCd]").each(function(){0!=$("input[class=categoryCd]:checked").length&&this.checked&&(t+=parseInt($("#categoryCd"+l).val())),l++});var d=0;return"popUpReg"==$("#tmpTak").val()&&(d=1),$("input").css("background-color",""),e.val().is_null()?(e.focus(),e.css("background-color","#A9F5BC"),void alert("이름을 입력하세요.")):a.val().is_null()?(a.focus(),a.css("background-color","#A9F5BC"),void alert("직위을 입력하세요.")):o.val().is_null()?(o.focus(),o.css("background-color","#A9F5BC"),void alert("email을 입력하세요.")):r.val().is_null()?(r.focus(),r.css("background-color","#A9F5BC"),void alert("전화번호를 입력하세요.")):(r=1==c.is(":checked")?"[N]"+r.val():r.val(),void(confirm("적용하시겠습니까?")&&$.ajax({type:"POST",url:"../person/insertCst.do",data:{cstNm:e.val(),categoryPSCd:"0000"+t,cpnId:n.val(),position:a.val(),email:o.val(),phn1:r,phn2:i.val(),phn3:s.val(),rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){if(1==d){$("#nameSearch").val(e.val());var n=document.getElementById("searchCst");n.action="popUpCst.do?f="+$("#flag").val()+"&n="+$("#num").val(),n.submit()}else{$("#nameSearch").val(e.val());var n=document.getElementById("searchCst");n.target="mainFrame",n.submit(),n=document.getElementById("personLeft"),n.target="leftFrame",n.submit()}},error:function(t,e){ajaxErrorAlert(t,e)}})))}),$(document).on("click",".popUpCstNm",function(){var t=$(this),e=t.attr("id").split("_");r="popUpCstPr"+e[1],$("#sNb2nd").val($("#sNb2_"+e[2]).val()),$("#name2nd").val($("#name2_"+e[2]).val()),$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".addNote",function(){var t=$(this),e=t.attr("id").split("_");r="addNotePr"+e[1],$(".popUpMenu").hide(),n($(this))}),$(document).on("click",".addNote1",function(){var t=$(this),e=t.attr("id").split("_");r="addNotePr"+e[1],$(".popUpMenu").hide();var a=$("#"+r).clone();a.attr("id","addNotePr"+(parseInt(e[1])+1)),a.find("input").attr("id","txt"+(parseInt(e[1])+1)),a.find("textarea").attr("id","resultarea"+(parseInt(e[1])+1)),$("#cloneDiv").append(a),n($(this))}),$(document).on("click",".nt_btnOk",function(){var t=$("#txt0").val();"이력/정보 제목"==$("#txt0").val()|""==$("#txt0").val()&&(t="무제");var e=$("#resultarea0").val();if(confirm("적용하시겠습니까?")){if(t.is_null())return void alert("제목을 입력하지 않았습니다.\n제목을 입력하세요.");$.ajax({type:"POST",url:"../person/insertNote.do",data:{cstSnb:$("#cst_snb").val(),title:t,note:e,rgId:$("#rgstId").val()},timeout:3e4,cache:!1,success:function(t){$("#s_Name").val($("#cst_snb").val());var e=document.getElementById("customerName");if("popUp"!=$("#rtn").val()){var n="mainFrame";"Y"==parent.insertStockFirmIbYN()&&(n="stockCstFrame"),e.target=n}e.submit()},error:function(t,e){ajaxErrorAlert(t,e)}})}}),$(document).on("click",".cloneOk",function(){var t=$(this),e=t.parent().parent().attr("id").split("Pr"),n=$("#txt"+e[1]).val(),a=$("#resultarea"+e[1]).val(),o=$("#cloneSpan1"),r=$("#info"+e[1]).clone();r.attr("id","info"+(parseInt(e[1])+1)),o.append(r),$("#info"+e[1]).html(n+":"+a),$("#addNote_"+e[1]).attr("id","addNote_"+(parseInt(e[1])+1)),$(".popUpMenu").hide()}),$(document).on("click","#excelDown",function(){var t=document.getElementById("excelDownload");t.action="test.do",t.submit()}),$(document).on("change","#choiceMonthS",function(){var t=document.getElementById("dayForm");t.submit()}),$(document).on("click","#totSum",function(){$("#choiceMonth").val($("#cur_month").val()),$("#total").val("tot");var t=document.getElementById("dayForm");t.submit()}),$(document).on("click","#carTotSum",function(){$("#total").val("tot");var t=document.getElementById("dayForm");t.submit()}),$(".savePersonnel").click(function(){var t=document.getElementById("personnel");t.action="insertPersonnelUse.do",
t.submit()}),$(".bgClr").click(function(){$("td").css("background-color","#ffffff");var t=$(this).parent(),e=t.attr("id"),n=e.split("_");t.parent().find("[id^="+n[0]+"_view]").css("background-color","#A9F5BC"),$("#"+n[0]+"_late").css("background-color","#A9F5BC"),$("#"+n[0]+"_sum").css("background-color","#A9F5BC"),$(".D"+n[2]).css("background-color","#F6CECE")}),$(".saveOverH").click(function(){var t=document.getElementById("overUsed");t.action="insertPersonnelOverUse.do",t.submit()}),$(document).on("change","#select_year",function(){var t=document.modifyRec;$("#choiceYear").val($("#select_year").val()),$("#choiceMonth").val(null),t.action="index.do",t.submit()}),$(document).on("change","#select_year2",function(){var t=document.modifyRec;$("#choiceYear").val($("#select_year").val()),$("#choiceMonth").val(null),t.action="viewIndex.do",t.submit()}),$(document).on("change",".delBtn",function(){var t=$(this).parent().parent().parent();t.parent().parent().parent().css("padding-bottom","-=20px"),t.remove()}),mozilaAjax=function(){$.ajax({type:"POST",url:"../company/searchName.do",data:{cpnNm:$("#nameSearch").val()},timeout:3e4,cache:!1,success:function(t){$("#idchk_commit").val(t)},error:function(t,e){ajaxErrorAlert(t,e)}})}});